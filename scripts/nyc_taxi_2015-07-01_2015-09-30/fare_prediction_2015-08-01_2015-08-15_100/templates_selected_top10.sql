SELECT {trip_distance} AS trip_distance, toDateTime('{pickup_datetime}') AS pickup_datetime ;
SELECT sum(trip_duration) AS sum_trip_duration_1h, sum(total_amount) AS sum_total_amount_1h, stddevPop(fare_amount) AS std_fare_amount_1h FROM trips WHERE ( pickup_datetime >= ( toDateTime('{pickup_datetime}') - toIntervalHour(1) ) ) AND (pickup_datetime < '{pickup_datetime}') AND (dropoff_datetime <= '{pickup_datetime}') AND (passenger_count = {passenger_count}) AND (pickup_ntaname = '{pickup_ntaname}') AND (dropoff_ntaname = '{dropoff_ntaname}');
SELECT count(*) AS count_24h, sum(trip_distance) AS sum_trip_distance_24h, max(trip_duration) AS max_trip_duration_24h, max(tip_amount) AS max_tip_amount_24h, median(tip_amount) AS median_tip_amount_24h FROM trips WHERE ( pickup_datetime >= ( toDateTime('{pickup_datetime}') - toIntervalHour(24) ) ) AND (pickup_datetime < '{pickup_datetime}') AND (dropoff_datetime <= '{pickup_datetime}') AND (passenger_count = {passenger_count}) AND (pickup_ntaname = '{pickup_ntaname}') AND (dropoff_ntaname = '{dropoff_ntaname}');
SELECT max(trip_distance) AS max_trip_distance_168h FROM trips WHERE ( pickup_datetime >= ( toDateTime('{pickup_datetime}') - toIntervalHour(168) ) ) AND (pickup_datetime < '{pickup_datetime}') AND (dropoff_datetime <= '{pickup_datetime}') AND (passenger_count = {passenger_count}) AND (pickup_ntaname = '{pickup_ntaname}') AND (dropoff_ntaname = '{dropoff_ntaname}')